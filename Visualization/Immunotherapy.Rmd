---
title: "Visualization of data"
output: html_notebook
---



```{r}
library(readxl)
data <- read_excel("C:/Users/daheekim/Desktop/Rfile/Immunotherapy.xlsx", 
    sheet = "Sheet1")
attach(data)
names(data)
head(data)
```

```{r}
with(data, table(sex, Type))
with(data, table(sex, Result_of_Treatment))
#value label
data$sex <- as.factor(data$sex)
data$Type <- as.factor(data$Type)
data$Result_of_Treatment <- as.factor(data$Result_of_Treatment)

data$sex <- factor(data$sex,
levels = c(1,2),
labels = c("male", "female"))

data$Type <- factor(data$Type,
levels = c(1,2,3),
labels = c("Common", "Plantar","Both"))

data$Result_of_Treatment <- factor(data$Result_of_Treatment,
levels = c(0,1),
labels = c("yes", "no"))


#ggplot for all variables
#color by Treatment
library(ggplot2)
library(gridExtra)

plot1 <- ggplot(data, aes(x=Time,y=Number_of_Warts,color=(Result_of_Treatment))) + 
  geom_point() +
  geom_smooth() +
  labs(y="Optimal Density(OD)") +
  theme(legend.position="none")
plot2<- ggplot(data, aes(x=Time,y=age,color=factor(Result_of_Treatment))) + 
  geom_point() +
  geom_smooth() +
  labs(y="DO") +
  theme(legend.position="none")
plot3<- ggplot(data, aes(x=Time,y=Number_of_Warts,color=factor(Type))) + 
  geom_point() +
  geom_smooth() +
  labs(y="Temp") +
  theme(legend.position="none")
plot4<- ggplot(data, aes(x=Time,y=age,color=factor(Type))) + 
  geom_point() +
  geom_smooth() +
  labs(y="pH")+
  theme(legend.position="none")
plot5<- ggplot(data, aes(x=Time,y=age,color=factor(sex))) + 
  geom_point() +
  geom_smooth() +
  labs(y="Absor_675") +
  theme(legend.position="none")
plot6<- ggplot(data, aes(x=Time,y=Area,color=factor(sex))) + 
  geom_point() +
  geom_smooth() +
  labs(y="Absor_440") +
  theme(legend.position = c(1, 0.2))
grid.arrange(plot1,plot2,plot3,plot4, plot5, plot6,ncol=3,nrow=2)
```

```{r}
library(reshape2)
names(data)

df <- melt(data[,c("sex","Type","Result_of_Treatment","age","Area","Time","Number_of_Warts","induration_diameter")], id=c("sex","Type","Result_of_Treatment","Time"))
ggplot(df,aes(x=Time,y=value,color=variable)) + 
  geom_point() +
  facet_wrap(~Result_of_Treatment) +
  geom_smooth() +
  labs(title="")

#interaction
ggplot(df,aes(x=Time,y=value,colour=interaction(sex,variable))) + 
  facet_wrap(~variable) +
  geom_point() +
  labs(title="Interaction with sex",x="Time", y = "value")
```

```{r}
ggplot(aes(y = age, x=sex, fill=sex), data = data)+  
  scale_fill_brewer(palette="Blues") +
  geom_boxplot(width = 0.5) +
  geom_jitter(position=position_jitter(width=.2), size=1) +
  labs(title="Age by Sex",x="sex", y = "age") +
 theme(legend.position = c(0.9, 0.9))
```

```{r}
library(dplyr) 
means_se <- data %>%  group_by(Type,Result_of_Treatment) %>% 
       summarise(mean=mean(age), sd=sd(age), lower=mean-sd, upper=mean+sd)
means_se

ggplot(means_se, aes(x=Type, y=mean,color=Result_of_Treatment)) + 
  labs(x="Type", y = "Sex") + 
  geom_crossbar(aes(ymin=lower, ymax=upper),position = position_dodge(1)) 

means_se1 <- data %>%  group_by(Time,Result_of_Treatment) %>% 
       summarise(mean=mean(age), sd=sd(age), lower=mean-sd, upper=mean+sd)
means_se1

ggplot(means_se1, aes(x=Time, y=mean,color=Result_of_Treatment)) + 
  labs(x="Type", y = "µ") + 
  geom_errorbar(aes(ymin=lower, ymax=upper),width=0.2) +       
  geom_line(size=1)+
  geom_crossbar(aes(ymin=lower, ymax=upper),position = position_dodge(1)) +
  geom_point()

```

```{r}
plot(data)
names(data)
```

```{r}
# Scatterplot
gg <- ggplot(data, aes(x=Area, y=age)) + 
  geom_point(aes(col=Type ,size=Type))
  geom_smooth(method="loess", se=F) + 
  xlim(c(0, 0.1)) + 
  ylim(c(0, 500000)) + 
  labs(subtitle="Area Vs Population", 
       y="Population", 
       x="Area", 
       title="Scatterplot", 
       caption = "Source: midwest")

plot(gg)
```

```{r}
# Plot

g <- ggplot(data, aes(x=Time, y=age))
g + geom_point() + 
  geom_smooth(method="lm", se=F) +
  labs(subtitle="mpg: city vs highway mileage", 
       y="hwy", 
       x="cty", 
       title="Scatterplot with overlapping points", 
       caption="Source: midwest")

g <- ggplot(data, aes(x=Time, y=age))+ 
  geom_count() + 
  geom_smooth(method="lm", se=F)
# Diverging Barcharts
ggplot(data, aes(x=Time, y=age)) + 
  geom_bar(stat='identity', aes(fill=sex), width=.5)  +
    scale_fill_manual(name="sex", 
                    labels = c("male", "female"), 
                    values = c("male"="#00ba38", "female"="#f8766d")) + 
  labs(subtitle="Normalised mileage from 'mtcars'", 
       title= "Diverging Bars") + 
  coord_flip()

```

```{r}
g <- ggplot(mpg, aes(class, cty))
g + geom_boxplot(varwidth=T, fill="plum") + 
    labs(title="Box plot", 
         subtitle="City Mileage grouped by Class of vehicle",
         caption="Source: mpg",
         x="Class of Vehicle",
         y="City Mileage")
```

```{r}

```

```{r}

```

```{r}

```

```{r}

```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.